@property --k {
	syntax: '<number>';
	initial-value: -1;
	inherits: true
}

@property --ang {
	syntax: '<angle>';
	initial-value: 0deg;
	inherits: false
}

* { margin: 0 }

html {
	scrollbar-width: none;
	height: calc(var(--n)*100%)
}

body, header, main, section, 
article, figure { display: grid }

body {
	--dir: 0;
	grid-template-rows: max-content 1fr max-content;
	position: fixed;
	width: 100%;
	height: 100vh;
	height: 100dvh;
	color: #dedede;
	font: clamp(.625em, 3vmin, 1.3em)/ 1.25 saira, sans-serif;
	animation: k 1s linear;
	animation-timeline: scroll();
	
	&::before {
		position: absolute;
		inset: 0;
		z-index: -1;
		background: #000;
		filter: url(#grain);
		content: ''
	}
	
	@media (max-aspect-ratio: 2/ 3) { --dir: 1 }
}

@keyframes k { to { --k: 1 } }

svg[height='0'][aria-hidden='true'] { position: fixed }

header {
	place-content: center;
	place-items: center;
	padding: .5em;
	text-align: center;
	text-wrap: balance
}

em { max-width: 32em }

main {
	overflow: hidden;
	perspective: 50em
}

section, article { transform-style: preserve-3d }

section {
	--r: calc(2 + var(--dir))/ 3;
	--w: clamp(4em, min(50vh, 25vw), 18em);
	--z: calc(var(--f, 1.25)*-.5*var(--w)/tan(.5turn/var(--n)));
	place-self: center;
	translate: 0 0 var(--z);
	rotate: var(--dir) calc(1 - var(--dir)) 0 calc((var(--k) + .5)*-1turn);
}

article, header, figure, img, figcaption { grid-area: 1/ 1 }

article {
	/* item progress value */
	--j: var(--i)/var(--n);
	/* linear difference between this item's progress value  
	 * and progress value of highlighted item in front - 
	 * it's a value in the [0, 1] interval */
	--dif-lin: calc(var(--j) - mod(var(--k) + 1, 1));
	/* absolute value of linear difference */
	--abs-lin: abs(var(--dif-lin));
	/* difference between middle & absolute linear difference */
	--dif-mid: calc(.5 - var(--abs-lin));
	--abs-mid: abs(var(--dif-mid));
	/* relative distance to from this item 
	 * to highlighted one in front */
	--dif-arc: calc(2*(.5 - var(--abs-mid)));
	/* relative distance limit */
	--lim: .15;
	--sel: max(0, calc((var(--lim) - var(--dif-arc))/var(--lim)));
	--out: calc(1 - var(--sel));
	--hov: 0;
	width: var(--w);
	aspect-ratio: var(--r);
	transform: 
		rotate3d(var(--dir), calc(1 - var(--dir)), 0, calc(var(--j)*1turn))
		translatez(var(--z))
		rotate(calc(var(--dir)*.5turn))
		scale(calc(1 + var(--hov)));
	transition: transform 0.35s ease-out;
	
	header { rotate: y calc(var(--hov)*.5turn) }
	
	@supports not (scale: abs(-1)) {
		--abs-lin: max(var(--dif-lin), -1*var(--dif-lin));
		--abs-mid: max(var(--dif-mid), -1*var(--dif-mid))
	}
	cursor: pointer;
}

article header, figure {
	--ang: calc(-45deg + var(--hov)*180deg);
	overflow: hidden;
	position: relative;
	border: solid 4px transparent;  /* Make border transparent by default */
	border-radius: .5em;
	backface-visibility: hidden;
	box-shadow: 5px 5px 13px #000;
	background: #2a2359;
	pointer-events: auto;  /* Enable click events */
	transition: .35s ease-out;
	transition-property: rotate, --ang;
}

/* Back side */
article header {
	font-size: 0.45em;     /* Further reduced font size for better fit without scrolling */
	line-height: 1.4;
	padding: 1.8em;
	text-align: left;
	display: flex;
	flex-direction: column;
	align-items: flex-start;
	overflow-y: auto;      /* Add scrolling only if absolutely necessary */
	max-height: 100%;      /* Ensure it doesn't overflow */
}

article header p {
	margin: 0 0 1em 0;
}

article header p:last-child {
	margin-bottom: 0;
}

/* Front side */
figure {
	rotate: y calc((1 + var(--hov))*.5turn);  /* Maintain flip effect */
	display: flex;
	align-items: center;
	justify-content: center;
}

figure div {
	font-size: 2.2em;
	font-weight: bold;
	text-align: center;
	line-height: 1.2;
	text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
}

/* Add specific styles for the front/back content */
.front {
	color: #fff;
	background: #000;  /* Solid black */
	width: 100%;
	height: 100%;
	display: flex;
	align-items: center;
	justify-content: center;
	font-size: 1.4em;
	padding: 0.5em;
	text-align: left;
}

.back {
	color: #fff;
	padding: 1em;
	font-size: 0.2em;
	text-align: center;
}

/* Remove any existing background-blend-mode or opacity effects */
article header, figure::after {
	opacity: 1;  /* Ensure full opacity */
	background: #000;
}

/* reverse from parent */
h2, em, img, a { pointer-events: auto }

h2, em { opacity: round(up, var(--sel)) }

h2 { font-size: 1.125em }

img {
	width: 100%;
	height: 100%;
	aspect-ratio: var(--r);
	object-fit: cover;
	object-position: var(--pos)
}

/* Styling for images on the backside of image posters */
.fullsize-image {
	width: 100%;
	height: 100%;
	object-fit: contain;
	padding: 0.5em;
	border-radius: 0.3em;
}

/*figcaption {
	align-self: end;
	padding: .5em;
	background: #fff3;
	color: #040404;
	font: Max(.75rem, .75em) caveat, cursive;
	text-align: right;
	text-shadow: 1px 1px 1px #0006;
	backdrop-filter: blur(5px) brightness(1.5);
	
	a { color: #370617 }
}

/* just support info boxes if it lacks support */
aside {
	position: fixed;
	bottom: 0;
	padding: .5em;
}

.box-info-scrollani {
	margin: .5em;
	border-left: solid 5px #dc3055;
	padding: .75em;
	box-shadow: 2px 2px 5px hsla(0, 0%, 0%, .35);
	background: #851d40;
	color: #fff;
	font: 1em/ 1.25 ubuntu, trebuchet ms, arial, sans-serif;
	
	@supports (animation-timeline: scroll()) { display: none }
}

kbd {
	padding: 2px;
	background: hsla(0, 0%, 0%, .35);
	font: 1.1em/ 1.2 ubuntu mono, consolas, monaco, monospace
}

.front-content {
	color: #fff;
	background: #2a2359;
	width: 100%;
	height: 100%;
	display: flex;
	flex-direction: column;
	align-items: flex-start;
	justify-content: center;
	font-size: 2.em;
	font-weight: bold;
	padding: 1.5em;
	text-align: left;
	text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
	line-height: 1.2;
	margin-left: 0.5em;
}

.back-content {
	color: #fff;
	background: #2a2359; /* Same dark purple */
	padding: 2em;
	font-size: 1.1em;
	line-height: 1.5;
	text-align: left; /* Matches template */
	height: 100%;
	display: flex;
	align-items: center;
}

@keyframes pulse {
    0% { border-color: rgba(244, 140, 6, 0.4) }
    50% { border-color: rgba(244, 140, 6, 0.8) }
    100% { border-color: rgba(244, 140, 6, 0.4) }
}

/* Add this new rule for the most centered article */
article.centered header, 
article.centered figure {
    animation: pulse 2s ease-in-out infinite;
    border: solid 4px rgba(244, 140, 6, 0.6);  /* #f48c06 with opacity */
}

.full-article {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    background: #000;
    z-index: 1000;
    overflow-y: auto;
    display: none; /* Hidden by default */
}

.full-article-content {
    padding: 4em 2em 2em 2em;
    color: #fff;
    position: relative;
    max-width: 1200px;
    margin: 0 auto;
}

.article-title {
    font-size: 2.5em;
    margin-bottom: 1em;
}

.close-article {
    position: fixed; /* Changed from absolute to fixed */
    top: 1em;
    right: 1em;
    background: none;
    border: none;
    color: #fff;
    font-size: 2em;
    cursor: pointer;
    padding: 0.5em;
    z-index: 1001; /* Above the article content */
}

/* Hide main content when full article is shown */
.main-hidden {
    display: none;
}

.chooser {
  position: absolute;
  top: 1em;
  right: 1em;
}

.chooser select {
  padding: 0.5em;
  background-color: #2a2359;
  color: #fff;
  border: none;
  border-radius: 0.25em;
  font-family: 'Saira', sans-serif;
  font-size: 0.9em;
  cursor: pointer;
}

.chooser select:hover {
  background-color: #3b3270;
}

/* Chronology styling for the front side */
.chronology-display {
  margin-top: 0.8em;
  font-size: 0.45em;
  text-align: center;
  line-height: 1.5;
  width: 80%;
  margin-left: auto;
  margin-right: auto;
}

figure .title {
  font-size: 2.5em;
  font-weight: bold;
  text-align: center;
  margin-bottom: 0.3em;
  padding-top: 1em;
}

.timeline-start, .timeline-end, .timeline-span {
  display: inline-block;
  background: rgba(255, 255, 255, 0.1);
  padding: 0.2em 0.5em;
  border-radius: 0.3em;
  margin: 0 0.2em 0.5em 0.2em;
  font-size: 1em;
}

.timeline-events {
  margin: 0.5em auto;
  width: 90%;
}

.event {
  margin-bottom: 0.4em;
  font-size: 1em;
  padding: 0.1em 0.3em;
}

.event .year {
  font-weight: bold;
  color: #f48c06;
}

/* Add to center the figure content vertically */
figure {
  display: flex !important;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 1em;
}
/* style.css (or your main stylesheet) */

/* Style for the images within image-type posters */
figure.image-poster-figure img {
	display: block; /* Removes potential extra space below the image */
	width: 100%;    /* Make the image fill the width of the figure */
	height: 100%;   /* Make the image fill the height of the figure */
	object-fit: contain; /* Scale the image while preserving aspect ratio, fitting it inside the container */
	object-position: center; /* Center the image within the figure */
  }
  
  /* Optional: Add some padding if the image touches the edges */
  /* figure.image-poster-figure {
	padding: 10px; 
	box-sizing: border-box; /* Ensure padding is included in the element's total width and height */
  /* } */
  
/* Add these styles to your style.css file */

/* Website preview container */
.website-preview-container {
	padding: 1.5em;
	height: 100%;
	display: flex;
	flex-direction: column;
	justify-content: center;
	background: linear-gradient(145deg, #2a2359, #1a153d);
	overflow: auto;
  }
  
  .website-info {
	text-align: center;
	max-width: 90%;
	margin: 0 auto;
  }
  
  .website-info h2 {
	font-size: 0.8em;
	margin-bottom: 0.5em;
	color: #fff;
  }
  
  .website-description {
	margin: 1em 0;
	color: #aaa;
	font-size: 0.6em;
  }
  
  .website-buttons {
	margin-top: 1.5em;
  }
  
  .website-open-button {
	display: inline-block;
	padding: 0.7em 1.5em;
	background-color: #4a95ee;
	color: white;
	text-decoration: none;
	border-radius: 4px;
	font-weight: bold;
	transition: background-color 0.2s;
  }
  
  .website-open-button:hover {
	background-color: #3a85dd;
  }
  
  .website-icon {
	margin-bottom: 1em;
  }
  
  .website-icon img {
	width: 48px;
	height: 48px;
	border-radius: 4px;
  }

.website-url {
  font-size: 0.6em;
  margin-top: 0.5em;
  color: #aaa;
  word-break: break-all;
  max-width: 90%;
}

.website-brief-description {
  font-size: 0.5em;
  margin-top: 0.7em;
  color: #ddd;
  text-align: center;
  max-width: 90%;
  margin-left: auto;
  margin-right: auto;
  line-height: 1.4;
}

/* Styles for website frontside */
.website-frontside-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 100%;
  padding: 0.8em;
}

.website-frontside-icon {
  margin-bottom: 0.5em;
  display: flex;
  justify-content: center;
  align-items: center;
}

.website-frontside-icon img {
  width: 48px;
  height: 48px;
  border-radius: 6px;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
  background-color: white;
  padding: 15px;
}

/* Adjust title size specifically for website posters */
.website-poster-figure .title {
  font-size: 1.2em;
  margin-bottom: 0.2em;
  text-align: center;
  line-height: 1.2;
  max-width: 90%;
}

.website-brief-description {
  font-size: 0.6em;
  margin-top: 0.4em;
  color: #ddd;
  text-align: center;
  max-width: 85%;
  margin-left: auto;
  margin-right: auto;
  margin-bottom: 0.2em;
  line-height: 1.3;
}

.website-poster-figure {
  display: flex !important;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  background: linear-gradient(145deg, #3a355e, #1e1a38);
  text-align: center;
  padding: 0.5em;
}